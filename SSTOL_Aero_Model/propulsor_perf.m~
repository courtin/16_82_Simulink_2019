function [dCJ, T] = propulsor_perf(thr, propulsor,c, alt, Vi) 
%%%%%%%%%%%%%%%%%%%%%%
%Computes two key propulsor outputs as a function of the throttle setting,
%aircraft state, and high-level parameters. 
%
%Inputs:    thr         Throttle setting for the propulsor (0-1)
%           propulsor   propulsor data structure, containing
%               .eta_v
%               .eta_add
%               .R
%           alt         Vehicle altitude
%           Vi          Flight speed
%           c           wing chord
%

%Compute the thrust/jet velocity of a single propulsor
Pshaft_one = propulsor.P_shaft_max*thr;
[~, ~, rho] = int_std_atm(alt);

[T, Vj] = get_motor_T(Pshaft_one, Vi, rho,propulsor);
%Correct the coefficients for the multiple propulsors distributed across
%the span
R = propulsor.R;
rh = propulsor.R_hub;

if propulsor.N > 1
    b = propulsor.b;
    hd_c = (pi*(R^2-rh^2)*(.5*b/R))/(b*c);
    [CQ, CJ, dCJ, CT, hj] = get_wake_coeffs(Vj,Vi, hd_c)
else
    hd
    [CQ, CJ, dCJ, CT, hj] = get_wake_coeffs(Vj, 2*(R-rh)/c);
end
