<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="8,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% compute the temperature, density and pressure ratios for</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% altitudes up to 20 km for the International Standard Atmosphere</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% Usage:    [T, p, rho, a, mu, delta, sigma, theta] = int_std_atm(h)</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% Input:    h      pressure altitude, m</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% Outputs:  T       temperature at altitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,10" id="srcline10">10</a></span><span class="line"><span class="comment">%           rho     density     "     "</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,11" id="srcline11">11</a></span><span class="line"><span class="comment">%           p       pressure    "     "</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,12" id="srcline12">12</a></span><span class="line"><span class="comment">%           a       speed of sound at altitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,13" id="srcline13">13</a></span><span class="line"><span class="comment">%           mu      kinematic viscosity</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,14" id="srcline14">14</a></span><span class="line"><span class="comment">%          </span></span></span>
<span class="srcline"><span class="lineno"><a href="8,15" id="srcline15">15</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,16" id="srcline16">16</a></span><span class="line"><span class="comment">%           delta  ratio of pressure    to sea level pressure</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,17" id="srcline17">17</a></span><span class="line"><span class="comment">%           sigma    "    " density     "   "    "   density</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,18" id="srcline18">18</a></span><span class="line"><span class="comment">%           theta    "    " temperature "   "    "   temperature</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,19" id="srcline19">19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="8,20" id="srcline20">20</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,21" id="srcline21">21</a></span><span class="line"><span class="comment">% Notes:  formulas taken from Appendix 2 of W. Austin Mair and</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,22" id="srcline22">22</a></span><span class="line"><span class="comment">%         David L. Birdsall, _Aircraft_Performance_, Cambridge</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,23" id="srcline23">23</a></span><span class="line"><span class="comment">%         Aerospace Series No. 5.  Cambridge: Cambridge Univ.</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,24" id="srcline24">24</a></span><span class="line"><span class="comment">%         Press, 1992.</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,25" id="srcline25">25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="8,26" id="srcline26">26</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T3U3">T</span>, <span class="var type1" id="S3T3U4">p</span>, <span class="var type1" id="S4T3U5">rho</span>, <span class="var type1" id="S5T3U6">a</span>, <span class="var type1" id="S6T3U7">mu</span>, <span class="var type1" id="S7T3U8">delta</span>, <span class="var type1" id="S8T3U9">sigma</span>, <span class="var type1" id="S9T3U10">theta</span>] = int_std_atm(<span class="var type1" id="S10T3U13">h_in</span>, <span class="var type0" id="S11T0U14">flight_condition_in</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="8,27" id="srcline27">27</a></span><span class="line"><span class="keyword">if</span> nargin == 1</span></span>
<span class="srcline"><span class="lineno"><a href="8,28" id="srcline28">28</a></span><span class="line">  <span class="mxinfo " id="T22:U10"><span class="var type1" id="S13T22U23">flight_condition</span> = <span class="mxinfo " id="T22:U12"><span class="string">'std day'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,29" id="srcline29">29</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,30" id="srcline30">30</a></span><span class="line">  <span class="var type0" id="S13T0U28">flight_condition</span> = <span class="var type0" id="S11T0U29">flight_condition_in</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,31" id="srcline31">31</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo " id="T3:U13"><span class="var type1" id="S14T3U32">h</span>   = <span class="mxinfo " id="T3:U15"><span class="var type1" id="S10T3U34">h_in</span> ./ <span class="mxinfo " id="T3:U17">1000</span></span></span>;  <span class="comment">%Convert m input to km</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="8,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T3:U18"><span class="var type1" id="S15T3U38">T0</span>  = <span class="mxinfo " id="T3:U20">288.15</span></span>;   <span class="comment">% K, sea level standard temperature</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T3:U21"><span class="var type1" id="S16T3U42">g</span>   = <span class="mxinfo " id="T3:U23">9.80665</span></span>;  <span class="comment">% m/s^2, gravitational acceleration</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T3:U24"><span class="var type1" id="S17T3U46">R</span>   = <span class="mxinfo " id="T3:U26">287.053</span></span>;  <span class="comment">% J/kg K, gas constant</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T3:U27"><span class="var type1" id="S18T3U50">p0</span>  = <span class="mxinfo " id="T3:U29">1.0132e5</span></span>; <span class="comment">%Pa, sea level standard pressure</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T3:U30"><span class="var type1" id="S19T3U54">rho0</span>= <span class="mxinfo " id="T3:U32">1.225</span></span>;    <span class="comment">%kg/m^3, sea level standard density</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,39" id="srcline39">39</a></span><span class="line"><span class="mxinfo " id="T3:U33"><span class="var type1" id="S20T3U58">mu0</span> = <span class="mxinfo " id="T3:U35">1.78e-5</span></span>; <span class="comment">%sea level</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,40" id="srcline40">40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="8,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo " id="T3:U36"><span class="var type1" id="S21T3U62">gam</span> = <span class="mxinfo " id="T3:U38">1.4</span></span>;      <span class="comment">%specific hear raio of air</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,42" id="srcline42">42</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="8,43" id="srcline43">43</a></span><span class="line"><span class="mxinfo " id="T3:U39"><span class="var type1" id="S22T3U66">T1</span> = <span class="mxinfo " id="T3:U41">216.65</span></span>;  <span class="comment">% K, constant temperature above 11 km</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,44" id="srcline44">44</a></span><span class="line"><span class="mxinfo " id="T3:U42"><span class="var type1" id="S23T3U70">Tsuth</span> = <span class="mxinfo " id="T3:U44">110.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,45" id="srcline45">45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="8,46" id="srcline46">46</a></span><span class="line"><span class="comment">%Correct for hot or cold days</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,47" id="srcline47">47</a></span><span class="line"><span class="keyword">switch</span> <span class="var type1" id="S13T22U73">flight_condition</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,48" id="srcline48">48</a></span><span class="line">  <span class="keyword">case</span> <span class="string">'std day'</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,49" id="srcline49">49</a></span><span class="line">    <span class="mxinfo " id="T3:U46"><span class="var type1" id="S24T3U78">dT</span> = <span class="mxinfo " id="T3:U48">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,50" id="srcline50">50</a></span><span class="line">  <span class="keyword">case</span> <span class="string">'hot day'</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,51" id="srcline51">51</a></span><span class="line">    <span class="var type0" id="S24T0U84">dT</span> = 15;</span></span>
<span class="srcline"><span class="lineno"><a href="8,52" id="srcline52">52</a></span><span class="line">    <span class="comment">%airplane.environment.dT = 29.9;  % 95 deg F at 5,000 ft MSL</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,53" id="srcline53">53</a></span><span class="line">  <span class="keyword">case</span> <span class="string">'cold day'</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,54" id="srcline54">54</a></span><span class="line">    <span class="var type0" id="S24T0U90">dT</span> = -15;</span></span>
<span class="srcline"><span class="lineno"><a href="8,55" id="srcline55">55</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,56" id="srcline56">56</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="8,57" id="srcline57">57</a></span><span class="line"><span class="comment">% compute the temperture, pressure, and density ratios</span></span></span>
<span class="srcline"><span class="lineno"><a href="8,58" id="srcline58">58</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="8,59" id="srcline59">59</a></span><span class="line"><span class="mxinfo " id="T3:U49"><span class="var type1" id="S25T3U95">theta_o</span>   = <span class="mxinfo " id="T3:U51">max(<span class="mxinfo " id="T3:U52"><span class="mxinfo " id="T3:U53">1</span> - <span class="mxinfo " id="T3:U54"><span class="mxinfo " id="T3:U55"><span class="mxinfo " id="T3:U56">6.5</span>*<span class="var type1" id="S14T3U103">h</span></span>/<span class="var type1" id="S15T3U104">T0</span></span></span>, <span class="mxinfo " id="T3:U59"><span class="var type1" id="S22T3U106">T1</span>/<span class="var type1" id="S15T3U107">T0</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,60" id="srcline60">60</a></span><span class="line"><span class="mxinfo " id="T3:U62"><span class="var type1" id="S9T3U110">theta</span> = <span class="mxinfo " id="T3:U64"><span class="var type1" id="S25T3U112">theta_o</span> + <span class="mxinfo " id="T3:U66"><span class="var type1" id="S24T3U114">dT</span>/<span class="var type1" id="S15T3U115">T0</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,61" id="srcline61">61</a></span><span class="line"><span class="mxinfo " id="T3:U69"><span class="var type1" id="S7T3U118">delta</span>   = <span class="mxinfo " id="T3:U71"><span class="mxinfo " id="T3:U72">(<span class="var type1" id="S25T3U122">theta_o</span>).^5.256</span>.*<span class="mxinfo " id="T3:U74">exp(<span class="mxinfo " id="T3:U75"><span class="mxinfo " id="T3:U76"><span class="mxinfo " id="T3:U77"><span class="mxinfo " id="T3:U78">-<span class="mxinfo " id="T3:U79">1000</span></span>*<span class="var type1" id="S16T3U131">g</span></span>*(<span class="mxinfo " id="T3:U81"><span class="mxinfo " id="T3:U82">max(<span class="var type1" id="S14T3U136">h</span>,<span class="mxinfo " id="T3:U84">11</span>)</span>-<span class="mxinfo " id="T3:U85">11</span></span>)</span>/(<span class="mxinfo " id="T3:U86"><span class="var type1" id="S17T3U141">R</span>*<span class="var type1" id="S22T3U142">T1</span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,62" id="srcline62">62</a></span><span class="line"><span class="mxinfo " id="T3:U89"><span class="var type1" id="S8T3U145">sigma</span>   = <span class="mxinfo " id="T3:U91"><span class="var type1" id="S7T3U147">delta</span>./<span class="var type1" id="S9T3U148">theta</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,63" id="srcline63">63</a></span><span class="line"><span class="mxinfo " id="T3:U94"><span class="var type1" id="S5T3U151">a</span>       = <span class="mxinfo " id="T3:U96">(<span class="mxinfo " id="T3:U97"><span class="mxinfo " id="T3:U98"><span class="mxinfo " id="T3:U99"><span class="var type1" id="S21T3U157">gam</span> .* <span class="var type1" id="S7T3U158">delta</span></span>.*<span class="var type1" id="S18T3U159">p0</span></span>./(<span class="mxinfo " id="T3:U103"><span class="var type1" id="S19T3U162">rho0</span>.*<span class="var type1" id="S8T3U163">sigma</span></span>)</span>).^.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,64" id="srcline64">64</a></span><span class="line"><span class="mxinfo " id="T3:U106"><span class="var type1" id="S6T3U167">mu</span>  = <span class="mxinfo " id="T3:U108"><span class="mxinfo " id="T3:U109"><span class="mxinfo " id="T3:U110"><span class="var type1" id="S20T3U171">mu0</span> * <span class="mxinfo " id="T3:U112"><span class="mxinfo " id="T3:U113">sqrt(<span class="var type1" id="S25T3U175">theta_o</span>)</span>^3.0</span></span> * (<span class="mxinfo " id="T3:U115"><span class="var type1" id="S15T3U179">T0</span> + <span class="var type1" id="S23T3U180">Tsuth</span></span>)</span> / (<span class="mxinfo " id="T3:U118"><span class="mxinfo " id="T3:U119"><span class="var type1" id="S25T3U184">theta_o</span>*<span class="var type1" id="S15T3U185">T0</span></span> + <span class="var type1" id="S23T3U186">Tsuth</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,65" id="srcline65">65</a></span><span class="line"><span class="mxinfo " id="T3:U123"><span class="var type1" id="S4T3U189">rho</span> = <span class="mxinfo " id="T3:U125"><span class="var type1" id="S8T3U191">sigma</span>*<span class="var type1" id="S19T3U192">rho0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,66" id="srcline66">66</a></span><span class="line"><span class="mxinfo " id="T3:U128"><span class="var type1" id="S2T3U195">T</span>   = <span class="mxinfo " id="T3:U130"><span class="var type1" id="S9T3U197">theta</span>*<span class="var type1" id="S15T3U198">T0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,67" id="srcline67">67</a></span><span class="line"><span class="mxinfo " id="T3:U133"><span class="var type1" id="S3T3U201">p</span>   = <span class="mxinfo " id="T3:U135"><span class="var type1" id="S7T3U203">delta</span>*<span class="var type1" id="S18T3U204">p0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="8,68" id="srcline68">68</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
